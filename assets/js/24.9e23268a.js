(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{429:function(s,e,a){"use strict";a.r(e);var n=a(2),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"nosql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nosql"}},[s._v("#")]),s._v(" NoSql")]),s._v(" "),e("blockquote",[e("p",[s._v('NoSQL(NoSQL = Not Only SQL )，即"不仅仅是SQL"\n非关系型的数据库')])]),s._v(" "),e("h3",{attrs:{id:"mongodb"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mongodb"}},[s._v("#")]),s._v(" MongoDB")]),s._v(" "),e("blockquote",[e("p",[s._v("MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。\nMongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。")])]),s._v(" "),e("blockquote",[e("p",[s._v("MongoDB 将数据存储为一个文档，数据结构由键值(key,value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。")])]),s._v(" "),e("h3",{attrs:{id:"mongodb-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-安装"}},[s._v("#")]),s._v(" MongoDB 安装")]),s._v(" "),e("blockquote",[e("p",[s._v("Windows "),e("a",{attrs:{href:"https://www.mongodb.com/download-center/community",target:"_blank",rel:"noopener noreferrer"}},[s._v("MongoDB"),e("OutboundLink")],1)])]),s._v(" "),e("h1",{attrs:{id:"mongodb-在-springboot中的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-在-springboot中的使用"}},[s._v("#")]),s._v(" MongoDB 在 SpringBoot中的使用")]),s._v(" "),e("p",[e("strong",[s._v("spring-data-mongodb 注解")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("@Id\n/*主键，不可重复，自带索引，可以在定义的列名上标注，需要自己生成并维护不重复的约束。\n如果自己不设置@Id主键，mongo会自动生成一个唯一主键，并且插入时效率远高于自己设置主键。\n在实际业务中不建议自己设置主键，应交给mongo自己生成，自己可以设置一个业务id，如int型字段，用自己设置的业务id来维护相关联的表。*/\n@Document  //标注在实体类上，类似于entity注解，标明由mongo来维护该表\n@Indexed   //声明该字段需要加索引，加索引后以该字段为条件检索将大大提高速度\n@CompoundIndex    //复合索引，加复合索引后通过复合索引字段查询将大大提高速度。\n@Field     //代表一个字段，可以不加，不加的话默认以参数名为列名\n@Transient //被该注解标注的，将不会被录入到数据库中。只作为普通的javaBean属性。\n@DBRef     //关联另一个document对象\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h2",{attrs:{id:"_1-引入依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-引入依赖"}},[s._v("#")]),s._v(" 1 引入依赖")]),s._v(" "),e("p",[e("code",[s._v("pom.xml")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<dependency>\n       <groupId>org.springframework.boot</groupId>\n       <artifactId>spring-boot-starter-data-mongodb</artifactId>\n</dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"_2-添加mongodb配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加mongodb配置"}},[s._v("#")]),s._v(" 2. 添加MongoDB配置")]),s._v(" "),e("p",[e("code",[s._v("application.yml")])]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mongodb")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uri")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mongodb"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//localhost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("27017/databaseName\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#有安全验证写法：")]),s._v("\n      uri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mongodb"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//username"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("password@localhost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("27017/databaseName\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"_3-测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-测试"}},[s._v("#")]),s._v(" 3. 测试")]),s._v(" "),e("p",[e("code",[s._v("MongoTemplateTest")])]),s._v(" "),e("h3",{attrs:{id:"_3-1-集合-collection-操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-集合-collection-操作"}},[s._v("#")]),s._v(" 3.1 集合(Collection)操作")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('public class MongoTemplateTest extends MongoDbTestApplicationTests{\n\n    @Autowired\n    MongoTemplate mongoTemplate;\n//    创建集合\n    @Test\n    public void testCreateCollection(){\n        if (!mongoTemplate.collectionExists("users")){\n            mongoTemplate.createCollection("users");\n        }\n    }\n//    删除集合\n    @Test\n    public void testDropCollection(){\n        mongoTemplate.dropCollection("users");\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h3",{attrs:{id:"_3-2-文档-document-操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-文档-document-操作"}},[s._v("#")]),s._v(" 3.2 文档(Document)操作")]),s._v(" "),e("p",[e("strong",[s._v("前置准备")]),s._v(" "),e("code",[s._v("创建entity包，创建User类")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@Data\n@Document("users")\npublic class User {\n    @Id\n    private Integer id;\n    @Field("username")\n    private String name;\n    @Field\n    private Double salary;\n    @Field\n    private Date birthday;\n\n    public User(Integer id, String name, Double salary, Date birthday) {\n        this.id = id;\n        this.name = name;\n        this.salary = salary;\n        this.birthday = birthday;\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("h4",{attrs:{id:"插入操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#插入操作"}},[s._v("#")]),s._v(" 插入操作")]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("save()")]),e("br"),s._v("\n插入重复数据时，对已有数据进行更新；\n批处理操作时，需要遍历整个数据，依次插入或更新，效率较低\n"),e("strong",[s._v("insert()")]),s._v("\n插入重复数据时，提示主键(_id)重复；\n批处理操作时，可以一次性插入整个数据，效率较高")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(' @Test\n    public void testSave(){\n//        save\n        User user = new User(1, "张三", 1500d, new Date());\n        mongoTemplate.save(user);\n//        insert\n        User user2 = new User(2, "李四", 1600d, new Date());\n        mongoTemplate.insert(user2);\n//        批处理\n        List<User> users = Arrays.asList(\n                new User(3, "张三", 1500d, new Date()),\n                new User(4, "李四", 1600d, new Date())\n        );\n        /*\n        参数1：批量数据\n        参数2：指明放入那个集合\n        * */\n//        mongoTemplate.insert(users,"users");\n        mongoTemplate.insert(users,User.class);\n\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("h4",{attrs:{id:"查询操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询操作"}},[s._v("#")]),s._v(" 查询操作")]),s._v(" "),e("p",[e("code",[s._v("查询所有 findALl")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    @Test\n    public void testFind(){\n        /*查询所有 findALl 指定查询某个集合\n          若实体没有@Document("users")注解，也可以在findAll方法中指定查询users表\n          List<User> users = mongoTemplate.findAll(User.class,"users");\n        */\n        List<User> users = mongoTemplate.findAll(User.class);\n        users.forEach(System.out::println);\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[e("code",[s._v("根据Id查询 findById")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("//根据Id查询 findById\nUser user = mongoTemplate.findById(1,User.class);\nSystem.out.println(user);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("code",[s._v("条件查询 find")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("//条件查询 find 参数1:查询条件    参数2:返回类型/查询的集合\nList<User> users = mongoTemplate.find(new Query(),User.class);\nusers.forEach(System.out::println);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("code",[s._v("等值查询")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Query query = Query.query(Criteria.where("name").is("张三"));\nList<User> users = mongoTemplate.find(query,User.class);\n\n//List<User> users = mongoTemplate.find(Query.query(Criteria.where("name").is("张三")),User.class);\n\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("code",[s._v(">,<,>=,<=")])]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v(">")]),s._v("gt  "),e("code",[s._v("<")]),s._v("lt "),e("code",[s._v(">=")]),s._v("gte  "),e("code",[s._v("<=")]),s._v("lte")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('List<User> users = mongoTemplate.find( Query.query(Criteria.where("salary").lt(1550));,User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("code",[s._v("and 查询")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Query query = Query.query(Criteria.where("name").is("张三").and("salary").lte(1500));\nList<User> users = mongoTemplate.find(query,User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("code",[s._v("or 查询")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Criteria criteria = new Criteria();\ncriteria.orOperator(\n       Criteria.where("name").is("张三"),\n       Criteria.where("name").is("李四")\n);\nList<User> users = mongoTemplate.find(Query.query(criteria),User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[e("code",[s._v("and & or")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('//这个表示的时 在"name"为"张三" 的基础上在查询"name"为"李四"的\nQuery query = Query.query(Criteria.where("name").is("张三").orOperator(Criteria.where("name").is("李四")));\nList<User> users = mongoTemplate.find(query,User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[e("code",[s._v("排序")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Query querySort = new Query();\nquerySort.with(Sort.by(Sort.Order.desc("salary")));    //asc  desc\nList<User> users = mongoTemplate.find(querySort,User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[e("code",[s._v("分页")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Query querySortPage = new Query();\nInteger pageSize=2;\nquerySortPage.with(Sort.by(Sort.Order.desc("salary")))\n             .with(Pageable.ofSize(pageSize));\nList<User> users = mongoTemplate.find(querySortPage,User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Query querySortPage = new Query();\nquerySortPage.with(Sort.by(Sort.Order.desc("salary")))\n             .skip(0)\n             .limit(2);   //pageSize\nList<User> users = mongoTemplate.find(querySortPage,User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("code",[s._v("查询总数")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('long count = mongoTemplate.count(new Query(), User.class);\nSystem.out.println(count);\n        \nlong count2 = mongoTemplate.count(Query.query(Criteria.where("name").is("张三")), User.class);\nSystem.out.println(count2);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[e("code",[s._v("去重")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('//去重 参数1:查询条件  参数2:去重的字段  参数3:查询的集合  参数4:返回的类型\nList<String> stringList = mongoTemplate.findDistinct(new Query(), "name", User.class, String.class);\nstringList.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("code",[s._v("使用 json 字符串方式查询")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('/*这种方式还可以支持 设定返回字段,不设置便全返回\n*_id 默认显示\n*投影中不可以同时 包容和排斥\n* "{name:0,salary:0}" √ "{name:1,salary:1}" √\n* "{name:1,salary:0}" ×\n*/\nBasicQuery basicQuery = new BasicQuery("{$or:[{name:\'张三\'},{salary:1600}]}","{id:0,salary:0}");\nList<User> users = mongoTemplate.find(basicQuery, User.class);\nusers.forEach(System.out::println);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"更新操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新操作"}},[s._v("#")]),s._v(" 更新操作")]),s._v(" "),e("p",[e("code",[s._v("更新查找到的第一条 updateFirst")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    @Test\n    public void testUpdate(){\n        Update update = new Update();\n        update.set("salary",2000);\n        mongoTemplate.updateFirst(Query.query(Criteria.where("name").is("张三")),update,User.class);\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("code",[s._v("多条更新 updateMulti")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Update update = new Update();\nupdate.set("salary",2000);\nmongoTemplate.updateMulti(Query.query(Criteria.where("name").is("张三")),update,User.class);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("code",[s._v("插入跟新 upsert")])]),s._v(" "),e("blockquote",[e("p",[s._v("没有符合条件时 插入数据")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Update update = new Update();\nupdate.setOnInsert("id",5); //当插入时，指定字段值\nupdate.set("salary",1500);\n\nmongoTemplate.upsert(Query.query(Criteria.where("name").is("王五")),update,User.class);\n//返回值\nSystem.out.println(updateResult.getModifiedCount());//获取本次修改的记录\nSystem.out.println(updateResult.getMatchedCount());//获取本次匹配的记录\nSystem.out.println(updateResult.getUpsertedId());//获取插入数据的id\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"删除操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除操作"}},[s._v("#")]),s._v(" 删除操作")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    @Test\n    public void testDelete(){\n        //删除所有\n        mongoTemplate.remove(new Query(),User.class);\n        //条件删除 \n        mongoTemplate.remove(Query.query(Criteria.where("name").is("王五")),User.class);\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);